{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Arrow = void 0;\n\nconst Factory_1 = require(\"../Factory\");\n\nconst Line_1 = require(\"./Line\");\n\nconst Validators_1 = require(\"../Validators\");\n\nconst Global_1 = require(\"../Global\");\n\nconst Path_1 = require(\"./Path\");\n\nclass Arrow extends Line_1.Line {\n  _sceneFunc(ctx) {\n    super._sceneFunc(ctx);\n\n    var PI2 = Math.PI * 2;\n    var points = this.points();\n    var tp = points;\n    var fromTension = this.tension() !== 0 && points.length > 4;\n\n    if (fromTension) {\n      tp = this.getTensionPoints();\n    }\n\n    var length = this.pointerLength();\n    var n = points.length;\n    var dx, dy;\n\n    if (fromTension) {\n      const lp = [tp[tp.length - 4], tp[tp.length - 3], tp[tp.length - 2], tp[tp.length - 1], points[n - 2], points[n - 1]];\n      const lastLength = Path_1.Path.calcLength(tp[tp.length - 4], tp[tp.length - 3], 'C', lp);\n      const previous = Path_1.Path.getPointOnQuadraticBezier(Math.min(1, 1 - length / lastLength), lp[0], lp[1], lp[2], lp[3], lp[4], lp[5]);\n      dx = points[n - 2] - previous.x;\n      dy = points[n - 1] - previous.y;\n    } else {\n      dx = points[n - 2] - points[n - 4];\n      dy = points[n - 1] - points[n - 3];\n    }\n\n    var radians = (Math.atan2(dy, dx) + PI2) % PI2;\n    var width = this.pointerWidth();\n\n    if (this.pointerAtEnding()) {\n      ctx.save();\n      ctx.beginPath();\n      ctx.translate(points[n - 2], points[n - 1]);\n      ctx.rotate(radians);\n      ctx.moveTo(0, 0);\n      ctx.lineTo(-length, width / 2);\n      ctx.lineTo(-length, -width / 2);\n      ctx.closePath();\n      ctx.restore();\n\n      this.__fillStroke(ctx);\n    }\n\n    if (this.pointerAtBeginning()) {\n      ctx.save();\n      ctx.beginPath();\n      ctx.translate(points[0], points[1]);\n\n      if (fromTension) {\n        dx = (tp[0] + tp[2]) / 2 - points[0];\n        dy = (tp[1] + tp[3]) / 2 - points[1];\n      } else {\n        dx = points[2] - points[0];\n        dy = points[3] - points[1];\n      }\n\n      ctx.rotate((Math.atan2(-dy, -dx) + PI2) % PI2);\n      ctx.moveTo(0, 0);\n      ctx.lineTo(-length, width / 2);\n      ctx.lineTo(-length, -width / 2);\n      ctx.closePath();\n      ctx.restore();\n\n      this.__fillStroke(ctx);\n    }\n  }\n\n  __fillStroke(ctx) {\n    var isDashEnabled = this.dashEnabled();\n\n    if (isDashEnabled) {\n      this.attrs.dashEnabled = false;\n      ctx.setLineDash([]);\n    }\n\n    ctx.fillStrokeShape(this);\n\n    if (isDashEnabled) {\n      this.attrs.dashEnabled = true;\n    }\n  }\n\n  getSelfRect() {\n    const lineRect = super.getSelfRect();\n    const offset = this.pointerWidth() / 2;\n    return {\n      x: lineRect.x - offset,\n      y: lineRect.y - offset,\n      width: lineRect.width + offset * 2,\n      height: lineRect.height + offset * 2\n    };\n  }\n\n}\n\nexports.Arrow = Arrow;\nArrow.prototype.className = 'Arrow';\n(0, Global_1._registerNode)(Arrow);\nFactory_1.Factory.addGetterSetter(Arrow, 'pointerLength', 10, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Arrow, 'pointerWidth', 10, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Arrow, 'pointerAtBeginning', false);\nFactory_1.Factory.addGetterSetter(Arrow, 'pointerAtEnding', true);","map":{"version":3,"names":["Object","defineProperty","exports","value","Arrow","Factory_1","require","Line_1","Validators_1","Global_1","Path_1","Line","_sceneFunc","ctx","PI2","Math","PI","points","tp","fromTension","tension","length","getTensionPoints","pointerLength","n","dx","dy","lp","lastLength","Path","calcLength","previous","getPointOnQuadraticBezier","min","x","y","radians","atan2","width","pointerWidth","pointerAtEnding","save","beginPath","translate","rotate","moveTo","lineTo","closePath","restore","__fillStroke","pointerAtBeginning","isDashEnabled","dashEnabled","attrs","setLineDash","fillStrokeShape","getSelfRect","lineRect","offset","height","prototype","className","_registerNode","Factory","addGetterSetter","getNumberValidator"],"sources":["D:/screenshort-extension/image-editor-react/node_modules/konva/lib/shapes/Arrow.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Arrow = void 0;\nconst Factory_1 = require(\"../Factory\");\nconst Line_1 = require(\"./Line\");\nconst Validators_1 = require(\"../Validators\");\nconst Global_1 = require(\"../Global\");\nconst Path_1 = require(\"./Path\");\nclass Arrow extends Line_1.Line {\n    _sceneFunc(ctx) {\n        super._sceneFunc(ctx);\n        var PI2 = Math.PI * 2;\n        var points = this.points();\n        var tp = points;\n        var fromTension = this.tension() !== 0 && points.length > 4;\n        if (fromTension) {\n            tp = this.getTensionPoints();\n        }\n        var length = this.pointerLength();\n        var n = points.length;\n        var dx, dy;\n        if (fromTension) {\n            const lp = [\n                tp[tp.length - 4],\n                tp[tp.length - 3],\n                tp[tp.length - 2],\n                tp[tp.length - 1],\n                points[n - 2],\n                points[n - 1],\n            ];\n            const lastLength = Path_1.Path.calcLength(tp[tp.length - 4], tp[tp.length - 3], 'C', lp);\n            const previous = Path_1.Path.getPointOnQuadraticBezier(Math.min(1, 1 - length / lastLength), lp[0], lp[1], lp[2], lp[3], lp[4], lp[5]);\n            dx = points[n - 2] - previous.x;\n            dy = points[n - 1] - previous.y;\n        }\n        else {\n            dx = points[n - 2] - points[n - 4];\n            dy = points[n - 1] - points[n - 3];\n        }\n        var radians = (Math.atan2(dy, dx) + PI2) % PI2;\n        var width = this.pointerWidth();\n        if (this.pointerAtEnding()) {\n            ctx.save();\n            ctx.beginPath();\n            ctx.translate(points[n - 2], points[n - 1]);\n            ctx.rotate(radians);\n            ctx.moveTo(0, 0);\n            ctx.lineTo(-length, width / 2);\n            ctx.lineTo(-length, -width / 2);\n            ctx.closePath();\n            ctx.restore();\n            this.__fillStroke(ctx);\n        }\n        if (this.pointerAtBeginning()) {\n            ctx.save();\n            ctx.beginPath();\n            ctx.translate(points[0], points[1]);\n            if (fromTension) {\n                dx = (tp[0] + tp[2]) / 2 - points[0];\n                dy = (tp[1] + tp[3]) / 2 - points[1];\n            }\n            else {\n                dx = points[2] - points[0];\n                dy = points[3] - points[1];\n            }\n            ctx.rotate((Math.atan2(-dy, -dx) + PI2) % PI2);\n            ctx.moveTo(0, 0);\n            ctx.lineTo(-length, width / 2);\n            ctx.lineTo(-length, -width / 2);\n            ctx.closePath();\n            ctx.restore();\n            this.__fillStroke(ctx);\n        }\n    }\n    __fillStroke(ctx) {\n        var isDashEnabled = this.dashEnabled();\n        if (isDashEnabled) {\n            this.attrs.dashEnabled = false;\n            ctx.setLineDash([]);\n        }\n        ctx.fillStrokeShape(this);\n        if (isDashEnabled) {\n            this.attrs.dashEnabled = true;\n        }\n    }\n    getSelfRect() {\n        const lineRect = super.getSelfRect();\n        const offset = this.pointerWidth() / 2;\n        return {\n            x: lineRect.x - offset,\n            y: lineRect.y - offset,\n            width: lineRect.width + offset * 2,\n            height: lineRect.height + offset * 2,\n        };\n    }\n}\nexports.Arrow = Arrow;\nArrow.prototype.className = 'Arrow';\n(0, Global_1._registerNode)(Arrow);\nFactory_1.Factory.addGetterSetter(Arrow, 'pointerLength', 10, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Arrow, 'pointerWidth', 10, (0, Validators_1.getNumberValidator)());\nFactory_1.Factory.addGetterSetter(Arrow, 'pointerAtBeginning', false);\nFactory_1.Factory.addGetterSetter(Arrow, 'pointerAtEnding', true);\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}