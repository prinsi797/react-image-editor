{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.HitCanvas = exports.SceneCanvas = exports.Canvas = void 0;\n\nconst Util_1 = require(\"./Util\");\n\nconst Context_1 = require(\"./Context\");\n\nconst Global_1 = require(\"./Global\");\n\nconst Factory_1 = require(\"./Factory\");\n\nconst Validators_1 = require(\"./Validators\");\n\nvar _pixelRatio;\n\nfunction getDevicePixelRatio() {\n  if (_pixelRatio) {\n    return _pixelRatio;\n  }\n\n  var canvas = Util_1.Util.createCanvasElement();\n  var context = canvas.getContext('2d');\n\n  _pixelRatio = function () {\n    var devicePixelRatio = Global_1.Konva._global.devicePixelRatio || 1,\n        backingStoreRatio = context.webkitBackingStorePixelRatio || context.mozBackingStorePixelRatio || context.msBackingStorePixelRatio || context.oBackingStorePixelRatio || context.backingStorePixelRatio || 1;\n    return devicePixelRatio / backingStoreRatio;\n  }();\n\n  Util_1.Util.releaseCanvas(canvas);\n  return _pixelRatio;\n}\n\nclass Canvas {\n  constructor(config) {\n    this.pixelRatio = 1;\n    this.width = 0;\n    this.height = 0;\n    this.isCache = false;\n    var conf = config || {};\n    var pixelRatio = conf.pixelRatio || Global_1.Konva.pixelRatio || getDevicePixelRatio();\n    this.pixelRatio = pixelRatio;\n    this._canvas = Util_1.Util.createCanvasElement();\n    this._canvas.style.padding = '0';\n    this._canvas.style.margin = '0';\n    this._canvas.style.border = '0';\n    this._canvas.style.background = 'transparent';\n    this._canvas.style.position = 'absolute';\n    this._canvas.style.top = '0';\n    this._canvas.style.left = '0';\n  }\n\n  getContext() {\n    return this.context;\n  }\n\n  getPixelRatio() {\n    return this.pixelRatio;\n  }\n\n  setPixelRatio(pixelRatio) {\n    var previousRatio = this.pixelRatio;\n    this.pixelRatio = pixelRatio;\n    this.setSize(this.getWidth() / previousRatio, this.getHeight() / previousRatio);\n  }\n\n  setWidth(width) {\n    this.width = this._canvas.width = width * this.pixelRatio;\n    this._canvas.style.width = width + 'px';\n\n    var pixelRatio = this.pixelRatio,\n        _context = this.getContext()._context;\n\n    _context.scale(pixelRatio, pixelRatio);\n  }\n\n  setHeight(height) {\n    this.height = this._canvas.height = height * this.pixelRatio;\n    this._canvas.style.height = height + 'px';\n\n    var pixelRatio = this.pixelRatio,\n        _context = this.getContext()._context;\n\n    _context.scale(pixelRatio, pixelRatio);\n  }\n\n  getWidth() {\n    return this.width;\n  }\n\n  getHeight() {\n    return this.height;\n  }\n\n  setSize(width, height) {\n    this.setWidth(width || 0);\n    this.setHeight(height || 0);\n  }\n\n  toDataURL(mimeType, quality) {\n    try {\n      return this._canvas.toDataURL(mimeType, quality);\n    } catch (e) {\n      try {\n        return this._canvas.toDataURL();\n      } catch (err) {\n        Util_1.Util.error('Unable to get data URL. ' + err.message + ' For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html.');\n        return '';\n      }\n    }\n  }\n\n}\n\nexports.Canvas = Canvas;\nFactory_1.Factory.addGetterSetter(Canvas, 'pixelRatio', undefined, (0, Validators_1.getNumberValidator)());\n\nclass SceneCanvas extends Canvas {\n  constructor() {\n    let config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n      width: 0,\n      height: 0,\n      willReadFrequently: false\n    };\n    super(config);\n    this.context = new Context_1.SceneContext(this, {\n      willReadFrequently: config.willReadFrequently\n    });\n    this.setSize(config.width, config.height);\n  }\n\n}\n\nexports.SceneCanvas = SceneCanvas;\n\nclass HitCanvas extends Canvas {\n  constructor() {\n    let config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n      width: 0,\n      height: 0\n    };\n    super(config);\n    this.hitCanvas = true;\n    this.context = new Context_1.HitContext(this);\n    this.setSize(config.width, config.height);\n  }\n\n}\n\nexports.HitCanvas = HitCanvas;","map":{"version":3,"names":["Object","defineProperty","exports","value","HitCanvas","SceneCanvas","Canvas","Util_1","require","Context_1","Global_1","Factory_1","Validators_1","_pixelRatio","getDevicePixelRatio","canvas","Util","createCanvasElement","context","getContext","devicePixelRatio","Konva","_global","backingStoreRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","releaseCanvas","constructor","config","pixelRatio","width","height","isCache","conf","_canvas","style","padding","margin","border","background","position","top","left","getPixelRatio","setPixelRatio","previousRatio","setSize","getWidth","getHeight","setWidth","_context","scale","setHeight","toDataURL","mimeType","quality","e","err","error","message","Factory","addGetterSetter","undefined","getNumberValidator","willReadFrequently","SceneContext","hitCanvas","HitContext"],"sources":["D:/screenshort-extension/image-editor-react/node_modules/konva/lib/Canvas.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HitCanvas = exports.SceneCanvas = exports.Canvas = void 0;\nconst Util_1 = require(\"./Util\");\nconst Context_1 = require(\"./Context\");\nconst Global_1 = require(\"./Global\");\nconst Factory_1 = require(\"./Factory\");\nconst Validators_1 = require(\"./Validators\");\nvar _pixelRatio;\nfunction getDevicePixelRatio() {\n    if (_pixelRatio) {\n        return _pixelRatio;\n    }\n    var canvas = Util_1.Util.createCanvasElement();\n    var context = canvas.getContext('2d');\n    _pixelRatio = (function () {\n        var devicePixelRatio = Global_1.Konva._global.devicePixelRatio || 1, backingStoreRatio = context.webkitBackingStorePixelRatio ||\n            context.mozBackingStorePixelRatio ||\n            context.msBackingStorePixelRatio ||\n            context.oBackingStorePixelRatio ||\n            context.backingStorePixelRatio ||\n            1;\n        return devicePixelRatio / backingStoreRatio;\n    })();\n    Util_1.Util.releaseCanvas(canvas);\n    return _pixelRatio;\n}\nclass Canvas {\n    constructor(config) {\n        this.pixelRatio = 1;\n        this.width = 0;\n        this.height = 0;\n        this.isCache = false;\n        var conf = config || {};\n        var pixelRatio = conf.pixelRatio || Global_1.Konva.pixelRatio || getDevicePixelRatio();\n        this.pixelRatio = pixelRatio;\n        this._canvas = Util_1.Util.createCanvasElement();\n        this._canvas.style.padding = '0';\n        this._canvas.style.margin = '0';\n        this._canvas.style.border = '0';\n        this._canvas.style.background = 'transparent';\n        this._canvas.style.position = 'absolute';\n        this._canvas.style.top = '0';\n        this._canvas.style.left = '0';\n    }\n    getContext() {\n        return this.context;\n    }\n    getPixelRatio() {\n        return this.pixelRatio;\n    }\n    setPixelRatio(pixelRatio) {\n        var previousRatio = this.pixelRatio;\n        this.pixelRatio = pixelRatio;\n        this.setSize(this.getWidth() / previousRatio, this.getHeight() / previousRatio);\n    }\n    setWidth(width) {\n        this.width = this._canvas.width = width * this.pixelRatio;\n        this._canvas.style.width = width + 'px';\n        var pixelRatio = this.pixelRatio, _context = this.getContext()._context;\n        _context.scale(pixelRatio, pixelRatio);\n    }\n    setHeight(height) {\n        this.height = this._canvas.height = height * this.pixelRatio;\n        this._canvas.style.height = height + 'px';\n        var pixelRatio = this.pixelRatio, _context = this.getContext()._context;\n        _context.scale(pixelRatio, pixelRatio);\n    }\n    getWidth() {\n        return this.width;\n    }\n    getHeight() {\n        return this.height;\n    }\n    setSize(width, height) {\n        this.setWidth(width || 0);\n        this.setHeight(height || 0);\n    }\n    toDataURL(mimeType, quality) {\n        try {\n            return this._canvas.toDataURL(mimeType, quality);\n        }\n        catch (e) {\n            try {\n                return this._canvas.toDataURL();\n            }\n            catch (err) {\n                Util_1.Util.error('Unable to get data URL. ' +\n                    err.message +\n                    ' For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html.');\n                return '';\n            }\n        }\n    }\n}\nexports.Canvas = Canvas;\nFactory_1.Factory.addGetterSetter(Canvas, 'pixelRatio', undefined, (0, Validators_1.getNumberValidator)());\nclass SceneCanvas extends Canvas {\n    constructor(config = { width: 0, height: 0, willReadFrequently: false }) {\n        super(config);\n        this.context = new Context_1.SceneContext(this, {\n            willReadFrequently: config.willReadFrequently,\n        });\n        this.setSize(config.width, config.height);\n    }\n}\nexports.SceneCanvas = SceneCanvas;\nclass HitCanvas extends Canvas {\n    constructor(config = { width: 0, height: 0 }) {\n        super(config);\n        this.hitCanvas = true;\n        this.context = new Context_1.HitContext(this);\n        this.setSize(config.width, config.height);\n    }\n}\nexports.HitCanvas = HitCanvas;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}